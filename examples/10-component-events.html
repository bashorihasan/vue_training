<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>10 - Component Events</title>
    <script src="../lib/vue/vue.global.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #42b983;
            border-bottom: 3px solid #42b983;
            padding-bottom: 10px;
        }

        .example-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #42b983;
        }

        .example-section h3 {
            color: #35495e;
            margin-top: 0;
        }

        .output {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #ddd;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #42b983;
            text-decoration: none;
            font-weight: bold;
        }

        .back-link:hover {
            color: #35495e;
        }

        button {
            background: #42b983;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }

        button:hover {
            background: #35495e;
        }

        button.danger {
            background: #dc3545;
        }

        button.danger:hover {
            background: #c82333;
        }

        input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px;
        }

        code {
            background: #282c34;
            color: #61dafb;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        pre {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .card {
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            border-left: 4px solid;
        }

        .alert-success {
            background: #d4edda;
            border-color: #28a745;
            color: #155724;
        }

        .alert-info {
            background: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }

        .todo-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .counter-display {
            font-size: 2em;
            font-weight: bold;
            color: #42b983;
            text-align: center;
            padding: 20px;
        }

        .message-box {
            background: #e9ecef;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">‚Üê Back to Home</a>
        
        <h1>10 - Component Events</h1>
        
        <p>
            Child components can emit events to communicate with their parent. The parent can 
            listen to these events using <code>v-on</code> or <code>@</code>.
        </p>

        <div class="example-section">
            <h3>Example 1: Basic Event Emission</h3>
            <p>Child component emits an event, parent listens:</p>
            <div id="app1" class="output">
                <div class="counter-display">{{ totalClicks }}</div>
                <click-button @button-clicked="totalClicks++"></click-button>
                <click-button @button-clicked="totalClicks++"></click-button>
                <click-button @button-clicked="totalClicks++"></click-button>
                <button @click="totalClicks = 0">Reset Total</button>
            </div>
            <pre><code>// Child Component
app.component('click-button', {
  template: `
    &lt;button @click="$emit('button-clicked')"&gt;
      Click Me
    &lt;/button&gt;
  `
});

// Parent
&lt;click-button @button-clicked="totalClicks++"&gt;&lt;/click-button&gt;</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 2: Emitting with Data</h3>
            <p>Pass data along with emitted events:</p>
            <div id="app2" class="output">
                <div v-if="lastMessage" class="alert alert-info">
                    {{ lastMessage }}
                </div>
                <message-button 
                    @send-message="handleMessage"
                    message="Hello from button 1!">
                </message-button>
                <message-button 
                    @send-message="handleMessage"
                    message="Greetings from button 2!">
                </message-button>
            </div>
            <pre><code>app.component('message-button', {
  props: ['message'],
  template: `
    &lt;button @click="$emit('send-message', message)"&gt;
      Send Message
    &lt;/button&gt;
  `
});

methods: {
  handleMessage(msg) {
    this.lastMessage = msg;
  }
}</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 3: Todo List with Events</h3>
            <p>Complex parent-child communication:</p>
            <div id="app3" class="output">
                <todo-input @add-todo="addTodo"></todo-input>
                <div v-if="todos.length === 0" class="message-box">
                    No todos yet. Add one above!
                </div>
                <todo-item
                    v-for="(todo, index) in todos"
                    :key="index"
                    :todo="todo"
                    @remove-todo="removeTodo(index)">
                </todo-item>
            </div>
            <pre><code>// Child: todo-input
app.component('todo-input', {
  data() {
    return { text: '' }
  },
  template: `
    &lt;div&gt;
      &lt;input v-model="text" @keyup.enter="addTodo"&gt;
      &lt;button @click="addTodo"&gt;Add Todo&lt;/button&gt;
    &lt;/div&gt;
  `,
  methods: {
    addTodo() {
      if (this.text.trim()) {
        this.$emit('add-todo', this.text);
        this.text = '';
      }
    }
  }
});

// Parent methods
methods: {
  addTodo(text) {
    this.todos.push(text);
  },
  removeTodo(index) {
    this.todos.splice(index, 1);
  }
}</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 4: Custom v-model</h3>
            <p>Create custom input components with v-model:</p>
            <div id="app4" class="output">
                <custom-input v-model="searchQuery"></custom-input>
                <div class="message-box">
                    <strong>Search Query:</strong> {{ searchQuery }}
                </div>
            </div>
            <pre><code>app.component('custom-input', {
  props: ['modelValue'],
  emits: ['update:modelValue'],
  template: `
    &lt;input
      :value="modelValue"
      @input="$emit('update:modelValue', $event.target.value)"
      placeholder="Type to search..."
    &gt;
  `
});

// Usage
&lt;custom-input v-model="searchQuery"&gt;&lt;/custom-input&gt;</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 5: Event Validation</h3>
            <p>Validate emitted events:</p>
            <div id="app5" class="output">
                <div class="alert alert-success" v-if="status">
                    {{ status }}
                </div>
                <validated-form @submit-form="handleFormSubmit"></validated-form>
            </div>
            <pre><code>app.component('validated-form', {
  emits: {
    'submit-form': (payload) => {
      return payload.name && payload.email;
    }
  },
  data() {
    return {
      name: '',
      email: ''
    }
  },
  methods: {
    submit() {
      this.$emit('submit-form', {
        name: this.name,
        email: this.email
      });
    }
  },
  template: `
    &lt;div&gt;
      &lt;input v-model="name" placeholder="Name"&gt;
      &lt;input v-model="email" placeholder="Email"&gt;
      &lt;button @click="submit"&gt;Submit&lt;/button&gt;
    &lt;/div&gt;
  `
});</code></pre>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        // Example 1: Basic Event
        const app1 = createApp({
            data() {
                return {
                    totalClicks: 0
                }
            }
        });
        app1.component('click-button', {
            template: `
                <button @click="$emit('button-clicked')">
                    Click Me
                </button>
            `
        });
        app1.mount('#app1');

        // Example 2: Event with Data
        const app2 = createApp({
            data() {
                return {
                    lastMessage: ''
                }
            },
            methods: {
                handleMessage(msg) {
                    this.lastMessage = `Received: ${msg}`;
                }
            }
        });
        app2.component('message-button', {
            props: ['message'],
            template: `
                <button @click="$emit('send-message', message)">
                    Send Message
                </button>
            `
        });
        app2.mount('#app2');

        // Example 3: Todo List
        const app3 = createApp({
            data() {
                return {
                    todos: []
                }
            },
            methods: {
                addTodo(text) {
                    this.todos.push(text);
                },
                removeTodo(index) {
                    this.todos.splice(index, 1);
                }
            }
        });
        app3.component('todo-input', {
            data() {
                return {
                    text: ''
                }
            },
            template: `
                <div>
                    <input v-model="text" @keyup.enter="addTodo" placeholder="Add a todo...">
                    <button @click="addTodo">Add Todo</button>
                </div>
            `,
            methods: {
                addTodo() {
                    if (this.text.trim()) {
                        this.$emit('add-todo', this.text);
                        this.text = '';
                    }
                }
            }
        });
        app3.component('todo-item', {
            props: ['todo'],
            template: `
                <div class="todo-item">
                    <span>{{ todo }}</span>
                    <button class="danger" @click="$emit('remove-todo')">Remove</button>
                </div>
            `
        });
        app3.mount('#app3');

        // Example 4: Custom v-model
        const app4 = createApp({
            data() {
                return {
                    searchQuery: ''
                }
            }
        });
        app4.component('custom-input', {
            props: ['modelValue'],
            emits: ['update:modelValue'],
            template: `
                <input
                    :value="modelValue"
                    @input="$emit('update:modelValue', $event.target.value)"
                    placeholder="Type to search..."
                    style="width: 100%; max-width: 400px;"
                >
            `
        });
        app4.mount('#app4');

        // Example 5: Event Validation
        const app5 = createApp({
            data() {
                return {
                    status: ''
                }
            },
            methods: {
                handleFormSubmit(payload) {
                    this.status = `Form submitted! Name: ${payload.name}, Email: ${payload.email}`;
                }
            }
        });
        app5.component('validated-form', {
            emits: {
                'submit-form': (payload) => {
                    return payload.name && payload.email;
                }
            },
            data() {
                return {
                    name: '',
                    email: ''
                }
            },
            methods: {
                submit() {
                    this.$emit('submit-form', {
                        name: this.name,
                        email: this.email
                    });
                }
            },
            template: `
                <div class="card">
                    <h4>User Form</h4>
                    <input v-model="name" placeholder="Name" style="display: block; width: 100%; max-width: 400px; margin: 10px 0;">
                    <input v-model="email" placeholder="Email" style="display: block; width: 100%; max-width: 400px; margin: 10px 0;">
                    <button @click="submit">Submit</button>
                </div>
            `
        });
        app5.mount('#app5');
    </script>
</body>
</html>
