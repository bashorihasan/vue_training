<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>06 - Computed Properties</title>
    <script src="../lib/vue/vue.global.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #42b983;
            border-bottom: 3px solid #42b983;
            padding-bottom: 10px;
        }

        .example-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #42b983;
        }

        .example-section h3 {
            color: #35495e;
            margin-top: 0;
        }

        .output {
            background: white;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            border: 1px solid #ddd;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #42b983;
            text-decoration: none;
            font-weight: bold;
        }

        .back-link:hover {
            color: #35495e;
        }

        button {
            background: #42b983;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }

        button:hover {
            background: #35495e;
        }

        input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin: 5px;
            width: 100%;
            max-width: 300px;
        }

        code {
            background: #282c34;
            color: #61dafb;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }

        pre {
            background: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }

        .highlight {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
            margin: 10px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }

        th, td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: #42b983;
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">‚Üê Back to Home</a>
        
        <h1>06 - Computed Properties</h1>
        
        <p>
            Computed properties are cached based on their reactive dependencies. They're perfect for 
            expensive operations or derived data that depends on other reactive properties.
        </p>

        <div class="example-section">
            <h3>Example 1: Basic Computed Property</h3>
            <p>Compute a value based on reactive data:</p>
            <div id="app1" class="output">
                <input v-model="firstName" placeholder="First Name">
                <input v-model="lastName" placeholder="Last Name">
                <div class="card">
                    <p><strong>Full Name:</strong> {{ fullName }}</p>
                </div>
            </div>
            <pre><code>&lt;input v-model="firstName"&gt;
&lt;input v-model="lastName"&gt;
&lt;p&gt;{{ fullName }}&lt;/p&gt;

data() {
  return {
    firstName: 'John',
    lastName: 'Doe'
  }
},
computed: {
  fullName() {
    return `${this.firstName} ${this.lastName}`;
  }
}</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 2: Computed vs Methods</h3>
            <p>Computed properties are cached, methods are not:</p>
            <div id="app2" class="output">
                <button @click="count++">Increment Count</button>
                <div class="card">
                    <p><strong>Count:</strong> {{ count }}</p>
                    <p><strong>Computed Result:</strong> {{ computedDouble }}</p>
                    <p><strong>Method Result:</strong> {{ methodDouble() }}</p>
                </div>
                <div class="highlight">
                    <p><strong>Note:</strong> Computed property is cached and only recalculates when 'count' changes. 
                    Method runs on every render.</p>
                </div>
            </div>
            <pre><code>computed: {
  computedDouble() {
    console.log('Computed called');
    return this.count * 2;
  }
},
methods: {
  methodDouble() {
    console.log('Method called');
    return this.count * 2;
  }
}</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 3: Shopping Cart Total</h3>
            <p>Calculate totals and derived data:</p>
            <div id="app3" class="output">
                <h4>Shopping Cart</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Price</th>
                            <th>Quantity</th>
                            <th>Subtotal</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr v-for="item in items" :key="item.id">
                            <td>{{ item.name }}</td>
                            <td>${{ item.price }}</td>
                            <td>
                                <button @click="item.quantity--" :disabled="item.quantity <= 0">-</button>
                                {{ item.quantity }}
                                <button @click="item.quantity++">+</button>
                            </td>
                            <td>${{ (item.price * item.quantity).toFixed(2) }}</td>
                        </tr>
                    </tbody>
                </table>
                <div class="card">
                    <p><strong>Subtotal:</strong> ${{ subtotal.toFixed(2) }}</p>
                    <p><strong>Tax (10%):</strong> ${{ tax.toFixed(2) }}</p>
                    <p><strong>Total:</strong> ${{ total.toFixed(2) }}</p>
                    <p><strong>Item Count:</strong> {{ totalItems }}</p>
                </div>
            </div>
            <pre><code>computed: {
  subtotal() {
    return this.items.reduce((sum, item) => 
      sum + (item.price * item.quantity), 0);
  },
  tax() {
    return this.subtotal * 0.1;
  },
  total() {
    return this.subtotal + this.tax;
  },
  totalItems() {
    return this.items.reduce((sum, item) => 
      sum + item.quantity, 0);
  }
}</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 4: Filtered List</h3>
            <p>Filter and sort data with computed properties:</p>
            <div id="app4" class="output">
                <input v-model="searchQuery" placeholder="Search users...">
                <select v-model="sortBy">
                    <option value="name">Sort by Name</option>
                    <option value="age">Sort by Age</option>
                    <option value="score">Sort by Score</option>
                </select>
                <div v-for="user in filteredUsers" :key="user.id" class="card">
                    <strong>{{ user.name }}</strong> - Age: {{ user.age }}, Score: {{ user.score }}
                </div>
                <p v-if="filteredUsers.length === 0">No users found.</p>
            </div>
            <pre><code>computed: {
  filteredUsers() {
    let filtered = this.users.filter(user =>
      user.name.toLowerCase().includes(
        this.searchQuery.toLowerCase()
      )
    );
    
    return filtered.sort((a, b) => {
      if (a[this.sortBy] < b[this.sortBy]) return -1;
      if (a[this.sortBy] > b[this.sortBy]) return 1;
      return 0;
    });
  }
}</code></pre>
        </div>

        <div class="example-section">
            <h3>Example 5: Getter and Setter</h3>
            <p>Computed properties can have both getter and setter:</p>
            <div id="app5" class="output">
                <label>Full Name (with getter/setter):</label>
                <input v-model="fullNameWithSetter" placeholder="Enter full name">
                <div class="card">
                    <p><strong>First Name:</strong> {{ first }}</p>
                    <p><strong>Last Name:</strong> {{ last }}</p>
                </div>
                <div class="highlight">
                    <p>Try entering a full name like "Jane Smith" in the input above!</p>
                </div>
            </div>
            <pre><code>computed: {
  fullNameWithSetter: {
    get() {
      return `${this.first} ${this.last}`;
    },
    set(value) {
      const parts = value.split(' ');
      this.first = parts[0] || '';
      this.last = parts[1] || '';
    }
  }
}</code></pre>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        // Example 1: Basic Computed
        createApp({
            data() {
                return {
                    firstName: 'John',
                    lastName: 'Doe'
                }
            },
            computed: {
                fullName() {
                    return `${this.firstName} ${this.lastName}`;
                }
            }
        }).mount('#app1');

        // Example 2: Computed vs Methods
        createApp({
            data() {
                return {
                    count: 0
                }
            },
            computed: {
                computedDouble() {
                    console.log('Computed called');
                    return this.count * 2;
                }
            },
            methods: {
                methodDouble() {
                    console.log('Method called');
                    return this.count * 2;
                }
            }
        }).mount('#app2');

        // Example 3: Shopping Cart
        createApp({
            data() {
                return {
                    items: [
                        { id: 1, name: 'Laptop', price: 999.99, quantity: 1 },
                        { id: 2, name: 'Mouse', price: 29.99, quantity: 2 },
                        { id: 3, name: 'Keyboard', price: 79.99, quantity: 1 }
                    ]
                }
            },
            computed: {
                subtotal() {
                    return this.items.reduce((sum, item) => sum + (item.price * item.quantity), 0);
                },
                tax() {
                    return this.subtotal * 0.1;
                },
                total() {
                    return this.subtotal + this.tax;
                },
                totalItems() {
                    return this.items.reduce((sum, item) => sum + item.quantity, 0);
                }
            }
        }).mount('#app3');

        // Example 4: Filtered List
        createApp({
            data() {
                return {
                    searchQuery: '',
                    sortBy: 'name',
                    users: [
                        { id: 1, name: 'Alice', age: 28, score: 95 },
                        { id: 2, name: 'Bob', age: 35, score: 87 },
                        { id: 3, name: 'Charlie', age: 23, score: 92 },
                        { id: 4, name: 'Diana', age: 31, score: 88 }
                    ]
                }
            },
            computed: {
                filteredUsers() {
                    let filtered = this.users.filter(user =>
                        user.name.toLowerCase().includes(this.searchQuery.toLowerCase())
                    );
                    
                    return filtered.sort((a, b) => {
                        if (a[this.sortBy] < b[this.sortBy]) return -1;
                        if (a[this.sortBy] > b[this.sortBy]) return 1;
                        return 0;
                    });
                }
            }
        }).mount('#app4');

        // Example 5: Getter and Setter
        createApp({
            data() {
                return {
                    first: 'John',
                    last: 'Doe'
                }
            },
            computed: {
                fullNameWithSetter: {
                    get() {
                        return `${this.first} ${this.last}`;
                    },
                    set(value) {
                        const parts = value.split(' ');
                        this.first = parts[0] || '';
                        this.last = parts[1] || '';
                    }
                }
            }
        }).mount('#app5');
    </script>
</body>
</html>
